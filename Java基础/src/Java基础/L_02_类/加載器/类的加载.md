
## Java类的生命周期

### 类加载器

#### 一、装载：查找和导入class文件

1、加载
  • 通过一个类的全限定名来获取定义此类的二进制字节流。
  • 将这个字节流所代表的静态存储结构转化为方法区的运行时数据结构。
  • 在Java堆中生成一个代表这个类的java.lang.Class对象，作为对方法区中这些数据的访问入口
  注意：这里的加载并没有规定类的获取渠道和方式，因此开发人员可以拓展。
  1、可以从zip包获取，JAR、WAR
  2、从网络中获取，比如 Applet
  3、运行时计算生成，使用较多的场景是动态代理。如 spring AOP

2、JVM在运行时会产生三个CLassLoader：
  
1、BootStrapClassLoader： 根/启动类装载器，只加载java、javax、sun等开头的类。
  2、ExtClassLoader 拓展类装载器，用来加载<JAVA_HOME>/lib/ext 目录下或者由系统变量-Djava.ext.dir指定路径中的类库
  3、AppClassLoader 加载系统类路径java -classpath或-D java.class.path 指定路径下的类库，也就是我们经常用到的classpath路径。
                    通过ClassLoader#getSystemClassLoader()方法可以获取到该类加载器。
#### 二、链接

1、验证 （验证载入的class文件的正确性）
  为了确保被加载类的正确性，分为以下几个阶段
  • 文件格式验证
  • 元数据验证
  • 字节码验证
  • 符号引用验证

2、准备 （给类的静态变量分配存储空间）
  • 仅仅为类的《静态》变量分配内存（方法区），并初始化默认值。（这个阶段只对类变量分配内存，实例变量会在堆中分配。）
  • 默认值是指数据类型的默认值，而非开发人员赋予的初始值。如果是final static修饰的成员则会被初始化为指定值

3、解析（将符号引用转成直接引用）
  • 解析阶段是虚拟机将常量池内的符号引用替换为直接引用的过程，解析动作主要针对类或接口、字段、类方法、接口方法、方法类型、方法句柄和调用点限定符7类符号引用进行。
  • 符号引用就是一组符号来描述目标，可以是任何字面量。
  • 直接引用就是直接指向目标的指针、相对偏移量或一个间接定位到目标的句柄
。
三、初始化（为类的静态变量，静态代码块执行初始化工作）
  • 为类的《静态》变量赋予正确的初始值，JVM负责对类进行初始化，主要对类变量进行初始化。   

6、使用
7、卸载